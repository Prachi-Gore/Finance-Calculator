rm(list=ls(all=TRUE))
s=1:3
p=matrix(c(1/6,1/6,4/6,1/2,0,1/2,1/3,2/3,0),byrow =T,ncol = 3)
k=nrow(p);
I=diag(1,nrow = k);I
A=rbind((I-p),c(rep(1,k)));A
b=matrix(c(rep(0,k),1))
c=t(A)%*%b
d=t(A)%*%A
solve(d,c)
rm(list=ls(all=TRUE))
s=1:3
p=matrix(c(1/6,1/6,4/6,1/2,0,1/2,1/3,2/3,0),byrow =T,ncol = 3)
k=nrow(p);
I=diag(1,nrow = k);I
A=rbind((I-p),c(rep(1,k)));A
b=matrix(c(rep(0,k),1))
c=t(A)%*%b
d=t(A)%*%A
solve(d,c)
rm(list=ls(all=TRUE))
s=1:3
p=matrix(c(1/6,1/6,4/6,1/2,0,1/2,1/3,2/3,0),byrow =T,ncol = 3)
k=nrow(p);
I=diag(1,nrow = k);I
A=rbind((I-p),c(rep(1,k)));A
b=matrix(c(rep(0,k),1))
c=t(A)%*%b
d=t(A)%*%A
solve(d,c)
rm(list=ls(all=TRUE))
s=1:3
p=matrix(c(1/6,1/6,4/6,1/2,0,1/2,1/3,2/3,0),byrow =T,ncol = 3)
k=nrow(p);
I=diag(1,nrow = k);I
A=rbind((I-p),c(rep(1,k)));A
b=matrix(c(rep(0,k),1),ncol = 1)
c=t(A)%*%b
d=t(A)%*%A
solve(d,c)
rm(list=ls(all=TRUE))
s=1:3
p=matrix(c(1/6,1/6,4/6,1/2,0,1/2,1/3,2/3,0),byrow =T,ncol = 3)
k=nrow(p);
I=diag(1,nrow = k);I
A=rbind((I-p),c(rep(1,k)));A
b=matrix(c(rep(0,k),1),ncol = 1)
c=t(A)%*%b
d=t(A)%*%A
solve(d,c)
n=30
sub=1:n;
drug=c("T","R")
p=0.5
cont=rep(0,n);res=rep(0,n);pr=rep(0,n);
cont[1]=sample(drug,1,prob=c(p,1-p))
res[1]=rbinom(1,1,ifelse(cont[1]=="T",0.6,0.4))
pr[1]=p
for (i in 2:n)
{
if((cont[i-1]=="T"&res[i-1]==1)||(cont[i-1]=="R"&res[i-1]==0)){
p=p+0.01
}else(p=p-0.01)
pr[i]=p
cont[i]=sample(drug,1,prob=c(p,1-p))
res[i]=rbinom(1,1,ifelse(cont[i]=="T",0.6,0.4))
}
out=data.frame("Prob"=pr,"Subject"=sub,"Group"=treat,"Response"=res)
n=30
sub=1:n;
drug=c("T","R")
p=0.5
cont=rep(0,n);res=rep(0,n);pr=rep(0,n);
cont[1]=sample(drug,1,prob=c(p,1-p))
res[1]=rbinom(1,1,ifelse(cont[1]=="T",0.6,0.4))
pr[1]=p
for (i in 2:n)
{
if((cont[i-1]=="T"&res[i-1]==1)||(cont[i-1]=="R"&res[i-1]==0)){
p=p+0.01
}else(p=p-0.01)
pr[i]=p
cont[i]=sample(drug,1,prob=c(p,1-p))
res[i]=rbinom(1,1,ifelse(cont[i]=="T",0.6,0.4))
}
out=data.frame("Prob"=pr,"Subject"=sub,"Group"=treat,"Response"=res)
n=30
sub=1:n;
drug=c("T","R")
p=0.5
cont=rep(0,n);res=rep(0,n);pr=rep(0,n);
cont[1]=sample(drug,1,prob=c(p,1-p))
res[1]=rbinom(1,1,ifelse(cont[1]=="T",0.6,0.4))
pr[1]=p
for (i in 2:n)
{
if((cont[i-1]=="T"&res[i-1]==1)||(cont[i-1]=="R"&res[i-1]==0)){
p=p+0.01
}else(p=p-0.01)
pr[i]=p
cont[i]=sample(drug,1,prob=c(p,1-p))
res[i]=rbinom(1,1,ifelse(cont[i]=="T",0.6,0.4))
}
out=data.frame("Prob"=pr,"Subject"=sub,"Group"=cont,"Response"=res)
print(out)
drug=c('placebo','active');n=25
p1=0.5 #placebo
p2=0.7 #active
s=0.02 # take it by own
treat=rep(0,n);
res=rep(0,n);
treat[1]=rbinom(1,1,p1)
res[1]=rbinom(1,1,p2)
for (i in 2:n) {
p1=ifelse(treat[i-1]==res[i-1],p1+s,p1-s)
treat[i]=rbinom(1,1,p1)
res[i]=rbinom(1,1,p2)
}
d=data.frame("subject"=1:n,treat,res)
d
d=data.frame("subject"=1:n,drug[treat+1],res)
d
res[1]=rbinom(1,1,ifelse(treat[1]==0,p1,p2))
drug=c('placebo','active');n=25
p1=0.5 #placebo
p2=0.7 #active
s=0.02 # take it by own
treat=rep(0,n);
res=rep(0,n);
treat[1]=rbinom(1,1,p1)
res[1]=rbinom(1,1,ifelse(treat[1]==0,p1,p2))
for (i in 2:n) {
p1=ifelse(treat[i-1]==res[i-1],p1+s,p1-s)
treat[i]=rbinom(1,1,p1)
res[i]=rbinom(1,1,ifelse(treat[i]==0,p1,p2))
}
d=data.frame("subject"=1:n,drug[treat+1],res)
d
#pk parameter
t=c(0,0.6,1.2,1.8,2.5,3.7,6.2,12,18,24,30,36)
c=c(0,0.58,0.73,1.66,3.42,4.61,5.06,5.14,4.51,4.21,3.09,2.19)
cmax=max(c);
a=which.max(c);
tmax=t[a];
k=length(c);
AUC_k=sum((c[2:k]+c[1:k-1])*(t[2:k]-t[1:k-1]))*0.5;
slope=coefficients(lm(log10c[a+1:k]~t[a+1:k]))[2];
slope=coefficients(lm(log10(c[a+1:k])~t[a+1:k]))[2];
eli_rate=-2.303*slope;
AUC_inf=AUC_k+(c[k]/eli_rate)
thalf=0.693/eli_rate
ans=cbind(cmax,tmax,AUC_k,AUC_inf,eli_rate,thalf)
ans
a=which.max(c);a
DA=c(2.5,2.25,2.35,2.60,2.10,2.45,2.50,2.1,2.2)
DB=c(2.45,2.50,2.60,2.77,2.60,2.55,2.65,2.75,2.45,2.50)
alpha=0.05
z=t.test(DA,DB,alternative="two.sided",var.equal=TRUE)
ifelse(z$p.value>alpha,"Reject Null Hypothesis","Fail to reject null hypothesis")
DA=c(2.5,2.25,2.35,2.60,2.10,2.45,2.50,2.1,2.2)
DB=c(2.45,2.50,2.60,2.77,2.60,2.55,2.65,2.75,2.45,2.50)
alpha=0.05
z=t.test(DA,DB,alternative="two.sided",var.equal=TRUE);z
ifelse(z$p.value>alpha,"Reject Null Hypothesis","Fail to reject null hypothesis")
plot(t,c)
n1=n2=6;
y11=c(290,187,168,294,250,293);
y12=c(210,116,77,140,161,240);
y21=c(201,200,151,97,228,154);
y22=c(212,277,193,253,201,232);
U1=y11+y12
U2=y21+y22
chat=mean(U2)-mean(U1)
var_u=(var(U1)*(n1-1)+var(U2)*(n2-1))/(n1+n2-2)
var_chat=var_u*((1/n1)+(1/n2))
tcal=chat/sqrt(var_chat)
pcal=2*(1-pt(abs(tcal),n1+n2-2))
alpha=0.05
talpha=pt(alpha,lower.tail = F,df=n1+n2-2)
LL=chat-talpha*sqrt(var_chat)
UL=chat+talpha*sqrt(var_chat)
cbind(LL,UL)
library(shiny); runApp('C:/Model_Monitoring_Tool/TRY.R')
runApp('C:/Model_Monitoring_Tool/TRY.R')
runApp('C:/Users/Prachi/Dropbox/pss/Model_Monitoring_Tool/layout.R')
runApp('C:/Model_Monitoring_Tool/copy_layout.R')
runApp('C:/Model_Monitoring_Tool/copy_layout.R')
runApp('C:/Model_Monitoring_Tool/copy_layout.R')
runApp('C:/Model_Monitoring_Tool/copy_layout.R')
runApp('C:/Model_Monitoring_Tool/copy_layout.R')
library(shiny); runApp('D:/Prachi_Seminar/seminar_r/demo.R')
runApp('D:/Prachi_Seminar/seminar_r/demo.R')
library(shiny); runApp('D:/Prachi_Seminar/seminar_r/boxplot.R')
runApp('D:/Prachi_Seminar/seminar_r/scatter.R')
runApp('D:/Prachi_Seminar/seminar_r/scatter.R')
library(shiny); runApp('D:/Prachi_Seminar/seminar_r/scatter.R')
shiny::runApp('C:/shiny_dashboard')
runApp('C:/shiny_dashboard')
runApp('C:/shiny_dashboard')
runApp('C:/shiny_dashboard')
runApp('C:/shiny_dashboard')
runApp('C:/shiny_dashboard')
runApp('C:/shiny_dashboard')
runApp('C:/shiny_dashboard/annuity_calculator.R')
runApp('C:/shiny_dashboard')
runApp()
runApp()
runApp('C:/shiny_dashboard')
runApp()
runApp()
runApp('C:/shiny_dashboard')
runApp('C:/shiny_dashboard')
shiny::runApp('C:/shiny_dashboard')
runApp('C:/shiny_dashboard/annuity_calculator.R')
runApp('C:/shiny_dashboard')
install.packages("rsconnect")
rsconnect::setAccountInfo(name='prachigore29', token='4038CB9A8B48B07E907BD39D7320ECCC', secret='d10Pgp6s42TGOxaxjT3H0fS8fYz7BKIH7lx5CNn+')
shiny::runApp('C:/shiny_dashboard')
runApp('C:/shiny_dashboard/annuity_calculator.R')
rsconnect::setAccountInfo(name='prachigore29', token='4038CB9A8B48B07E907BD39D7320ECCC', secret='d10Pgp6s42TGOxaxjT3H0fS8fYz7BKIH7lx5CNn+')
source("C:/shiny_dashboard/annuity_calculator.R", echo=TRUE)
runApp('C:/shiny_dashboard')
runApp('C:/shiny_dashboard')
runApp()
runApp()
runApp('C:/shiny_dashboard')
shiny::runApp()
runApp()
runApp()
runApp()
